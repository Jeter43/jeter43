# stocks.yaml 文件作用说明 - 2025-11-23

## 📋 文件概述

`stocks.yaml` 是**股票池配置文件**，用于定义和管理多个股票池（watchlists），为交易系统提供预设的股票列表。

**文件位置：** `quant_system/config/stocks.yaml`

---

## 🎯 主要作用

### 1. **定义股票池（Watchlists）**

股票池是一组预定义的股票列表，可以按不同维度分类：
- **按市场分类**：港股主板、港股科技板块等
- **按行业分类**：金融股、科技股、能源股等
- **按用途分类**：测试股票池、蓝筹股池等

### 2. **为策略提供数据源**

股票池可以被各种选股策略使用：
- **自选股策略**（`PriorityStocksStrategy`）：直接使用股票池中的股票
- **混合策略**（`MixedStrategy`）：结合股票池和技术分析
- **技术分析策略**（`TechnicalSelectionStrategy`）：可以基于股票池进行筛选

### 3. **简化股票管理**

通过配置文件管理股票，无需修改代码：
- 添加/删除股票只需编辑YAML文件
- 支持多个股票池，灵活组合使用
- 便于版本控制和团队协作

---

## 📊 当前配置的股票池

根据 `stocks.yaml` 文件，当前定义了 **4个股票池**：

### 1. **hk_main（港股主板）**
- **描述**：香港主板市场主要股票
- **股票数量**：10只
- **包含股票**：腾讯控股、汇丰控股、中国移动、友邦保险、港交所等

### 2. **hk_tech（港股科技板块）**
- **描述**：香港科技类股票
- **股票数量**：7只
- **包含股票**：腾讯、阿里巴巴、京东、百度、美团等

### 3. **test_small（测试股票池）**
- **描述**：用于开发和测试的小型股票池
- **股票数量**：3只
- **包含股票**：腾讯、汇丰、中国移动
- **用途**：快速测试，避免全市场分析耗时

### 4. **hk_blue_chip（港股蓝筹股）**
- **描述**：恒生指数成分股
- **股票数量**：45只
- **包含股票**：恒生指数主要成分股，如长和、中电控股、汇丰控股、腾讯控股等

---

## 🔧 在系统中的使用

### 加载流程

1. **系统初始化时加载**
   ```python
   # main.py 初始化 StockPoolManager
   self.stock_pool_manager = StockPoolManager("config/stocks.yaml")
   ```

2. **StockPoolManager 读取配置**
   ```python
   # stock_pool_manager.py
   def _load_stock_pools(self):
       with open(self.config_path, 'r', encoding='utf-8') as f:
           data = yaml.safe_load(f)
       watchlists = data.get('watchlists', {})
       # 加载所有股票池...
   ```

3. **策略使用股票池**
   ```python
   # 在策略中获取股票池
   stock_pool = self.stock_pool_manager.get_stocks_from_pool('hk_main')
   ```

### 使用场景

1. **自选股策略**
   - 直接使用股票池中的股票作为候选
   - 适合关注特定股票的投资者

2. **混合策略**
   - 结合股票池和技术分析
   - 在股票池基础上进行技术筛选

3. **测试和开发**
   - 使用 `test_small` 股票池快速测试
   - 避免全市场分析耗时

---

## 📝 文件格式

```yaml
watchlists:
  # 股票池ID（唯一标识）
  pool_id:
    name: "股票池名称"
    description: "股票池描述"
    stocks:
      - "HK.00700"  # 股票代码（带注释说明）
      - "HK.00005"
      # ...
```

### 字段说明

- **watchlists**：顶层键，包含所有股票池
- **pool_id**：股票池唯一标识符（如 `hk_main`、`hk_tech`）
- **name**：股票池显示名称
- **description**：股票池描述说明
- **stocks**：股票代码列表（格式：`HK.股票代码`）

---

## 🔄 与全市场选股的关系

### 重要区别

1. **股票池（stocks.yaml）**
   - 预定义的股票列表
   - 数量有限（通常几十到几百只）
   - 手动维护
   - 适合特定策略或测试

2. **全市场选股**
   - 自动获取所有正股（约1500-2000只港股主板正股）
   - 通过API动态获取
   - 适合全市场扫描和筛选

### 使用建议

- **使用股票池**：当你关注特定股票或板块时
- **使用全市场**：当你想要发现新的投资机会时
- **混合使用**：在股票池基础上进行全市场筛选

---

## 🛠️ 如何修改股票池

### 添加新股票池

```yaml
watchlists:
  # 现有股票池...
  
  # 新增股票池
  my_custom_pool:
    name: "我的自定义股票池"
    description: "我关注的股票"
    stocks:
      - "HK.00700"
      - "HK.09988"
      # ...
```

### 修改现有股票池

直接编辑 `stocks.yaml` 文件，添加或删除股票代码即可。

### 保存修改

系统会在运行时自动加载配置。如果需要持久化修改，可以调用：
```python
stock_pool_manager.save_config()  # 保存到文件
```

---

## ⚠️ 注意事项

1. **股票代码格式**
   - 必须使用 `HK.` 前缀（如 `HK.00700`）
   - 代码必须是有效的港股代码

2. **文件路径**
   - 默认路径：`config/stocks.yaml`
   - 如果文件不存在，系统会创建默认股票池

3. **YAML格式**
   - 注意缩进（使用空格，不要使用Tab）
   - 注意引号（股票代码建议用引号包裹）

4. **性能考虑**
   - 股票池数量不宜过多（建议<10个）
   - 单个股票池的股票数量建议<1000只

---

## 📚 相关代码文件

- **配置文件**：`quant_system/config/stocks.yaml`
- **管理器**：`quant_system/domain/services/stock_pool_manager.py`
- **使用示例**：`quant_system/domain/strategies/selection_priority.py`

---

## 🎯 总结

`stocks.yaml` 文件是交易系统的**股票池配置中心**，它：

1. ✅ 定义了多个预设股票池
2. ✅ 为策略提供数据源
3. ✅ 简化股票管理
4. ✅ 支持灵活配置和扩展

通过这个文件，你可以轻松管理关注的股票，无需修改代码即可调整股票池配置。


